# ===================================================================
# netlify.toml - Основной файл конфигурации Netlify
# ===================================================================

[build]
  # Netlify будет искать код Serverless-функций в этой папке
  functions = "netlify/functions"
  # Папка для публикации статических файлов (требуется для Netlify)
  publish = "public" 

# Настройка Заголовков (CORS) для всех ваших функций
# Упрощенная версия для корректной обработки OPTIONS-запросов
[[headers]]
  # Применяем эти заголовки ко всем функциям
  for = "/.netlify/functions/*" 
  [headers.values]
    # Разрешаем доступ с любого домена (для вашего фронтенда на GitHub Pages)
    Access-Control-Allow-Origin = "*"
    # Разрешаем все основные методы, включая OPTIONS (для Preflight request)
    Access-Control-Allow-Methods = "GET, POST, OPTIONS, PUT, PATCH, DELETE"
    # Разрешаем только самые необходимые заголовки (устраняет конфликты)
    Access-Control-Allow-Headers = "Content-Type"
    # Максимальное время кэширования для OPTIONS-ответа (ускоряет работу)
    Access-Control-Max-Age = "86400"

# Если вы хотите, чтобы ваш фронтенд использовал короткие пути типа /api/list,
# а не длинные /.netlify/functions/list, используйте это перенаправление:
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200
